"use strict";const inputEl=document.querySelector("#show"),buttonEl=document.querySelector(".button"),resultList=document.querySelector(".result-list"),favoriteListUl=document.querySelector(".favorite-list");let seriesList=[],favoriteShowsArray=JSON.parse(localStorage.getItem("favoriteShowsArray"))||[];function paintPrincipalList(){if(seriesList.length)for(let e=0;e<seriesList.length;e++){const t=seriesList[e].show.name,r=seriesList[e].show.id,i=document.createElement("li");i.classList.add("show-result");for(const e of favoriteShowsArray)r==e.id&&i.classList.add("show-result--favorite");const a=document.createElement("h3"),s=document.createTextNode(t),o=document.createElement("img");if(resultList.appendChild(i),i.appendChild(a),a.appendChild(s),i.appendChild(o),i.setAttribute("data-id",`${r}`),i.addEventListener("click",addToFavoritesList),seriesList[e].show.image){const t=seriesList[e].show.image.medium;o.src=t}else o.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"}else{const e=`No hay resultados para ${inputShow} :(`,t=document.createElement("li");t.classList.add("message");const r=document.createTextNode(e);resultList.appendChild(t),t.appendChild(r)}}function removeFav(e){for(let t=0;t<favoriteShowsArray.length;t++)if(favoriteShowsArray[t].id===e){favoriteShowsArray.splice(t,1),favoriteListUl.innerHTML="";for(let e=0;e<favoriteShowsArray.length;e++)createList(favoriteShowsArray[e].imgUrl,favoriteShowsArray[e].name,favoriteShowsArray[e].id)}}function handleRemoveFavorite(e){const{currentTarget:t}=e,{id:r}=t.dataset;removeFav(r),saveToLocalStorage(),cleanList(),paintPrincipalList(),console.log(favoriteShowsArray)}function searchHandler(e){e.preventDefault(),cleanList();const t=inputEl.value;if(t)fetch(`http://api.tvmaze.com/search/shows?q=${t}`).then(function(e){return e.json()}).then(function(e){seriesList=e,paintPrincipalList()});else{const e="Introduce el nombre de una serie y pincha en la lupa",t=document.createElement("li");t.classList.add("message");const r=document.createTextNode(e);resultList.appendChild(t),t.appendChild(r)}}function cleanList(){resultList.innerHTML&&(resultList.innerHTML="")}function createList(e,t,r){const i=document.createElement("li");i.classList.add("favorite-item");const a=document.createElement("h3");a.classList.add("favorite-item__title");const s=document.createElement("img");s.classList.add("favorite-item__img");const o=document.createElement("i");o.classList.add("fas"),o.classList.add("fa-times-circle"),o.classList.add("favorite__remove-btn"),o.addEventListener("click",handleRemoveFavorite),o.setAttribute("data-id",`${r}`),favoriteListUl.appendChild(i),i.appendChild(s),i.appendChild(a),i.setAttribute("data-id",`${r}`),i.appendChild(o),s.src=e,a.innerHTML=t}function addToFavoritesList(e){const t={};t.name=e.currentTarget.children[0].innerHTML,t.imgUrl=e.currentTarget.children[1].src,t.id=e.currentTarget.getAttribute("data-id"),e.currentTarget.classList.toggle("show-result--favorite"),e.currentTarget.classList.contains("show-result--favorite")?(createList(t.imgUrl,t.name,t.id),console.log(favoriteShowsArray),favoriteShowsArray.push(t)):(removeFav(t.id),console.log(favoriteShowsArray)),saveToLocalStorage()}function saveToLocalStorage(){localStorage.setItem("favoriteShowsArray",JSON.stringify(favoriteShowsArray))}function init(){if(buttonEl.addEventListener("click",searchHandler),favoriteShowsArray)for(let e=0;e<favoriteShowsArray.length;e++)createList(favoriteShowsArray[e].imgUrl,favoriteShowsArray[e].name,favoriteShowsArray[e].id)}init();